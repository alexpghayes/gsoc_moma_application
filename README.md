
<!-- README.md is generated from README.Rmd. Please edit that file -->
GSOC Modern Multivariate Analysis
=================================

**This application is in progress and is not yet complete**

So far I have: - Implemented L1 penalized rank 1 SFPCA algorithm in R - Implemented L1 penalized rank 1 SFPCA algorithm in C++ using Armadillo

Next steps: - Legitimate tests based on the provided MATLAB code - Make sure to pass R CMD check - Some general code cleanup

At this point both the R and C++ code runs and I get the same values when on the `iris` dataset:

``` r
library(moma)

X <- as.matrix(iris[, 1:4])
sfpca(X, 10, 4)  
#> $u
#>                [,1]
#>   [1,]  0.000000000
#>   [2,]  0.000000000
#>   [3,]  0.000000000
#>   [4,]  0.000000000
#>   [5,]  0.000000000
#>   [6,]  0.000000000
#>   [7,]  0.000000000
#>   [8,]  0.000000000
#>   [9,]  0.000000000
#>  [10,]  0.000000000
#>  [11,]  0.000000000
#>  [12,]  0.000000000
#>  [13,]  0.000000000
#>  [14,]  0.000000000
#>  [15,]  0.000000000
#>  [16,]  0.000000000
#>  [17,]  0.000000000
#>  [18,]  0.000000000
#>  [19,]  0.000000000
#>  [20,]  0.000000000
#>  [21,]  0.000000000
#>  [22,]  0.000000000
#>  [23,]  0.000000000
#>  [24,]  0.000000000
#>  [25,]  0.000000000
#>  [26,]  0.000000000
#>  [27,]  0.000000000
#>  [28,]  0.000000000
#>  [29,]  0.000000000
#>  [30,]  0.000000000
#>  [31,]  0.000000000
#>  [32,]  0.000000000
#>  [33,]  0.000000000
#>  [34,]  0.000000000
#>  [35,]  0.000000000
#>  [36,]  0.000000000
#>  [37,]  0.000000000
#>  [38,]  0.000000000
#>  [39,]  0.000000000
#>  [40,]  0.000000000
#>  [41,]  0.000000000
#>  [42,]  0.000000000
#>  [43,]  0.000000000
#>  [44,]  0.000000000
#>  [45,]  0.000000000
#>  [46,]  0.000000000
#>  [47,]  0.000000000
#>  [48,]  0.000000000
#>  [49,]  0.000000000
#>  [50,]  0.000000000
#>  [51,]  0.000000000
#>  [52,]  0.000000000
#>  [53,]  0.000000000
#>  [54,]  0.000000000
#>  [55,]  0.000000000
#>  [56,]  0.000000000
#>  [57,]  0.000000000
#>  [58,]  0.000000000
#>  [59,]  0.000000000
#>  [60,]  0.000000000
#>  [61,]  0.000000000
#>  [62,]  0.000000000
#>  [63,]  0.000000000
#>  [64,]  0.000000000
#>  [65,]  0.000000000
#>  [66,]  0.000000000
#>  [67,]  0.000000000
#>  [68,]  0.000000000
#>  [69,]  0.000000000
#>  [70,]  0.000000000
#>  [71,]  0.000000000
#>  [72,]  0.000000000
#>  [73,]  0.000000000
#>  [74,]  0.000000000
#>  [75,]  0.000000000
#>  [76,]  0.000000000
#>  [77,]  0.000000000
#>  [78,]  0.000000000
#>  [79,]  0.000000000
#>  [80,]  0.000000000
#>  [81,]  0.000000000
#>  [82,]  0.000000000
#>  [83,]  0.000000000
#>  [84,]  0.000000000
#>  [85,]  0.000000000
#>  [86,]  0.000000000
#>  [87,]  0.000000000
#>  [88,]  0.000000000
#>  [89,]  0.000000000
#>  [90,]  0.000000000
#>  [91,]  0.000000000
#>  [92,]  0.000000000
#>  [93,]  0.000000000
#>  [94,]  0.000000000
#>  [95,]  0.000000000
#>  [96,]  0.000000000
#>  [97,]  0.000000000
#>  [98,]  0.000000000
#>  [99,]  0.000000000
#> [100,]  0.000000000
#> [101,]  0.000000000
#> [102,]  0.000000000
#> [103,]  0.000000000
#> [104,]  0.000000000
#> [105,]  0.000000000
#> [106,] -0.309477330
#> [107,]  0.000000000
#> [108,] -0.063002295
#> [109,]  0.000000000
#> [110,] -0.171520873
#> [111,]  0.000000000
#> [112,]  0.000000000
#> [113,]  0.000000000
#> [114,]  0.000000000
#> [115,]  0.000000000
#> [116,]  0.000000000
#> [117,]  0.000000000
#> [118,] -0.545228963
#> [119,] -0.367752511
#> [120,]  0.000000000
#> [121,]  0.000000000
#> [122,]  0.000000000
#> [123,] -0.327189463
#> [124,]  0.000000000
#> [125,]  0.000000000
#> [126,] -0.002393635
#> [127,]  0.000000000
#> [128,]  0.000000000
#> [129,]  0.000000000
#> [130,]  0.000000000
#> [131,] -0.037328434
#> [132,] -0.525588309
#> [133,]  0.000000000
#> [134,]  0.000000000
#> [135,]  0.000000000
#> [136,] -0.231567260
#> [137,]  0.000000000
#> [138,]  0.000000000
#> [139,]  0.000000000
#> [140,]  0.000000000
#> [141,]  0.000000000
#> [142,]  0.000000000
#> [143,]  0.000000000
#> [144,]  0.000000000
#> [145,]  0.000000000
#> [146,]  0.000000000
#> [147,]  0.000000000
#> [148,]  0.000000000
#> [149,]  0.000000000
#> [150,]  0.000000000
#> 
#> $d
#> [1] 27.58352
#> 
#> $v
#>             [,1]
#> [1,] -0.75532804
#> [2,] -0.21368353
#> [3,] -0.61509321
#> [4,] -0.07402199
sfpca_r(X, 10, 4)
#> $u
#>                [,1]
#>   [1,]  0.000000000
#>   [2,]  0.000000000
#>   [3,]  0.000000000
#>   [4,]  0.000000000
#>   [5,]  0.000000000
#>   [6,]  0.000000000
#>   [7,]  0.000000000
#>   [8,]  0.000000000
#>   [9,]  0.000000000
#>  [10,]  0.000000000
#>  [11,]  0.000000000
#>  [12,]  0.000000000
#>  [13,]  0.000000000
#>  [14,]  0.000000000
#>  [15,]  0.000000000
#>  [16,]  0.000000000
#>  [17,]  0.000000000
#>  [18,]  0.000000000
#>  [19,]  0.000000000
#>  [20,]  0.000000000
#>  [21,]  0.000000000
#>  [22,]  0.000000000
#>  [23,]  0.000000000
#>  [24,]  0.000000000
#>  [25,]  0.000000000
#>  [26,]  0.000000000
#>  [27,]  0.000000000
#>  [28,]  0.000000000
#>  [29,]  0.000000000
#>  [30,]  0.000000000
#>  [31,]  0.000000000
#>  [32,]  0.000000000
#>  [33,]  0.000000000
#>  [34,]  0.000000000
#>  [35,]  0.000000000
#>  [36,]  0.000000000
#>  [37,]  0.000000000
#>  [38,]  0.000000000
#>  [39,]  0.000000000
#>  [40,]  0.000000000
#>  [41,]  0.000000000
#>  [42,]  0.000000000
#>  [43,]  0.000000000
#>  [44,]  0.000000000
#>  [45,]  0.000000000
#>  [46,]  0.000000000
#>  [47,]  0.000000000
#>  [48,]  0.000000000
#>  [49,]  0.000000000
#>  [50,]  0.000000000
#>  [51,]  0.000000000
#>  [52,]  0.000000000
#>  [53,]  0.000000000
#>  [54,]  0.000000000
#>  [55,]  0.000000000
#>  [56,]  0.000000000
#>  [57,]  0.000000000
#>  [58,]  0.000000000
#>  [59,]  0.000000000
#>  [60,]  0.000000000
#>  [61,]  0.000000000
#>  [62,]  0.000000000
#>  [63,]  0.000000000
#>  [64,]  0.000000000
#>  [65,]  0.000000000
#>  [66,]  0.000000000
#>  [67,]  0.000000000
#>  [68,]  0.000000000
#>  [69,]  0.000000000
#>  [70,]  0.000000000
#>  [71,]  0.000000000
#>  [72,]  0.000000000
#>  [73,]  0.000000000
#>  [74,]  0.000000000
#>  [75,]  0.000000000
#>  [76,]  0.000000000
#>  [77,]  0.000000000
#>  [78,]  0.000000000
#>  [79,]  0.000000000
#>  [80,]  0.000000000
#>  [81,]  0.000000000
#>  [82,]  0.000000000
#>  [83,]  0.000000000
#>  [84,]  0.000000000
#>  [85,]  0.000000000
#>  [86,]  0.000000000
#>  [87,]  0.000000000
#>  [88,]  0.000000000
#>  [89,]  0.000000000
#>  [90,]  0.000000000
#>  [91,]  0.000000000
#>  [92,]  0.000000000
#>  [93,]  0.000000000
#>  [94,]  0.000000000
#>  [95,]  0.000000000
#>  [96,]  0.000000000
#>  [97,]  0.000000000
#>  [98,]  0.000000000
#>  [99,]  0.000000000
#> [100,]  0.000000000
#> [101,]  0.000000000
#> [102,]  0.000000000
#> [103,]  0.000000000
#> [104,]  0.000000000
#> [105,]  0.000000000
#> [106,] -0.309477330
#> [107,]  0.000000000
#> [108,] -0.063002295
#> [109,]  0.000000000
#> [110,] -0.171520873
#> [111,]  0.000000000
#> [112,]  0.000000000
#> [113,]  0.000000000
#> [114,]  0.000000000
#> [115,]  0.000000000
#> [116,]  0.000000000
#> [117,]  0.000000000
#> [118,] -0.545228963
#> [119,] -0.367752511
#> [120,]  0.000000000
#> [121,]  0.000000000
#> [122,]  0.000000000
#> [123,] -0.327189463
#> [124,]  0.000000000
#> [125,]  0.000000000
#> [126,] -0.002393635
#> [127,]  0.000000000
#> [128,]  0.000000000
#> [129,]  0.000000000
#> [130,]  0.000000000
#> [131,] -0.037328434
#> [132,] -0.525588309
#> [133,]  0.000000000
#> [134,]  0.000000000
#> [135,]  0.000000000
#> [136,] -0.231567260
#> [137,]  0.000000000
#> [138,]  0.000000000
#> [139,]  0.000000000
#> [140,]  0.000000000
#> [141,]  0.000000000
#> [142,]  0.000000000
#> [143,]  0.000000000
#> [144,]  0.000000000
#> [145,]  0.000000000
#> [146,]  0.000000000
#> [147,]  0.000000000
#> [148,]  0.000000000
#> [149,]  0.000000000
#> [150,]  0.000000000
#> 
#> $d
#> [1] 27.58352
#> 
#> $v
#>                     [,1]
#> Sepal.Length -0.75532804
#> Sepal.Width  -0.21368353
#> Petal.Length -0.61509321
#> Petal.Width  -0.07402199
```

The results match up with a standard rank 1 SVD when no penalties are included.

``` r
irlba::irlba(X, 1, 1)
#> $d
#> [1] 95.95991
#> 
#> $u
#>               [,1]
#>   [1,] -0.06161685
#>   [2,] -0.05807094
#>   [3,] -0.05676305
#>   [4,] -0.05665344
#>   [5,] -0.06123020
#>   [6,] -0.06750317
#>   [7,] -0.05748208
#>   [8,] -0.06097263
#>   [9,] -0.05376120
#>  [10,] -0.05882666
#>  [11,] -0.06529182
#>  [12,] -0.05994178
#>  [13,] -0.05711323
#>  [14,] -0.05159575
#>  [15,] -0.06800719
#>  [16,] -0.07076259
#>  [17,] -0.06536474
#>  [18,] -0.06179182
#>  [19,] -0.06928030
#>  [20,] -0.06351469
#>  [21,] -0.06517277
#>  [22,] -0.06329358
#>  [23,] -0.05596085
#>  [24,] -0.06295342
#>  [25,] -0.06154560
#>  [26,] -0.05992289
#>  [27,] -0.06185719
#>  [28,] -0.06293418
#>  [29,] -0.06200349
#>  [30,] -0.05836687
#>  [31,] -0.05875351
#>  [32,] -0.06445351
#>  [33,] -0.06513574
#>  [34,] -0.06752039
#>  [35,] -0.05900164
#>  [36,] -0.05857663
#>  [37,] -0.06421316
#>  [38,] -0.06027249
#>  [39,] -0.05362268
#>  [40,] -0.06175536
#>  [41,] -0.06047448
#>  [42,] -0.05180777
#>  [43,] -0.05441485
#>  [44,] -0.06260324
#>  [45,] -0.06582810
#>  [46,] -0.05746319
#>  [47,] -0.06387433
#>  [48,] -0.05651492
#>  [49,] -0.06450909
#>  [50,] -0.06004194
#>  [51,] -0.09504224
#>  [52,] -0.08945161
#>  [53,] -0.09510761
#>  [54,] -0.07581925
#>  [55,] -0.08918460
#>  [56,] -0.08203819
#>  [57,] -0.09030916
#>  [58,] -0.06725177
#>  [59,] -0.09001346
#>  [60,] -0.07469578
#>  [61,] -0.06751936
#>  [62,] -0.08314196
#>  [63,] -0.07881188
#>  [64,] -0.08680939
#>  [65,] -0.07684008
#>  [66,] -0.09069413
#>  [67,] -0.08239759
#>  [68,] -0.07976147
#>  [69,] -0.08392527
#>  [70,] -0.07650959
#>  [71,] -0.08766671
#>  [72,] -0.08249608
#>  [73,] -0.08803469
#>  [74,] -0.08606335
#>  [75,] -0.08684418
#>  [76,] -0.08951532
#>  [77,] -0.09242703
#>  [78,] -0.09403062
#>  [79,] -0.08513242
#>  [80,] -0.07537501
#>  [81,] -0.07479617
#>  [82,] -0.07408658
#>  [83,] -0.07904221
#>  [84,] -0.08772287
#>  [85,] -0.08083213
#>  [86,] -0.08728784
#>  [87,] -0.09247293
#>  [88,] -0.08421953
#>  [89,] -0.07990920
#>  [90,] -0.07661142
#>  [91,] -0.07897096
#>  [92,] -0.08667087
#>  [93,] -0.07918073
#>  [94,] -0.06763841
#>  [95,] -0.07925555
#>  [96,] -0.08105157
#>  [97,] -0.08083045
#>  [98,] -0.08527872
#>  [99,] -0.06778447
#> [100,] -0.07989976
#> [101,] -0.09883385
#> [102,] -0.08668234
#> [103,] -0.10267292
#> [104,] -0.09388623
#> [105,] -0.09761690
#> [106,] -0.11032883
#> [107,] -0.07528798
#> [108,] -0.10545579
#> [109,] -0.09650202
#> [110,] -0.10760130
#> [111,] -0.09431687
#> [112,] -0.09244794
#> [113,] -0.09818630
#> [114,] -0.08474780
#> [115,] -0.08795331
#> [116,] -0.09512829
#> [117,] -0.09531317
#> [118,] -0.11498985
#> [119,] -0.11148098
#> [120,] -0.08503284
#> [121,] -0.10118037
#> [122,] -0.08461872
#> [123,] -0.11067901
#> [124,] -0.08935180
#> [125,] -0.09966105
#> [126,] -0.10425751
#> [127,] -0.08843055
#> [128,] -0.08897460
#> [129,] -0.09479780
#> [130,] -0.10204616
#> [131,] -0.10494820
#> [132,] -0.11460154
#> [133,] -0.09497278
#> [134,] -0.09029217
#> [135,] -0.09043259
#> [136,] -0.10878848
#> [137,] -0.09691653
#> [138,] -0.09492653
#> [139,] -0.08765726
#> [140,] -0.09883051
#> [141,] -0.09885919
#> [142,] -0.09757664
#> [143,] -0.08668234
#> [144,] -0.10146686
#> [145,] -0.10036095
#> [146,] -0.09614970
#> [147,] -0.08926921
#> [148,] -0.09405930
#> [149,] -0.09488961
#> [150,] -0.08847836
#> 
#> $v
#>            [,1]
#> [1,] -0.7511082
#> [2,] -0.3800862
#> [3,] -0.5130089
#> [4,] -0.1679075
#> 
#> $iter
#> [1] 0
#> 
#> $mprod
#> [1] 0
sfpca(X)
#> $u
#>               [,1]
#>   [1,] -0.06161685
#>   [2,] -0.05807094
#>   [3,] -0.05676305
#>   [4,] -0.05665344
#>   [5,] -0.06123020
#>   [6,] -0.06750317
#>   [7,] -0.05748208
#>   [8,] -0.06097263
#>   [9,] -0.05376120
#>  [10,] -0.05882666
#>  [11,] -0.06529182
#>  [12,] -0.05994178
#>  [13,] -0.05711323
#>  [14,] -0.05159575
#>  [15,] -0.06800719
#>  [16,] -0.07076259
#>  [17,] -0.06536474
#>  [18,] -0.06179182
#>  [19,] -0.06928030
#>  [20,] -0.06351469
#>  [21,] -0.06517277
#>  [22,] -0.06329358
#>  [23,] -0.05596085
#>  [24,] -0.06295342
#>  [25,] -0.06154560
#>  [26,] -0.05992289
#>  [27,] -0.06185719
#>  [28,] -0.06293418
#>  [29,] -0.06200349
#>  [30,] -0.05836687
#>  [31,] -0.05875351
#>  [32,] -0.06445351
#>  [33,] -0.06513574
#>  [34,] -0.06752039
#>  [35,] -0.05900164
#>  [36,] -0.05857663
#>  [37,] -0.06421316
#>  [38,] -0.06027249
#>  [39,] -0.05362268
#>  [40,] -0.06175536
#>  [41,] -0.06047448
#>  [42,] -0.05180777
#>  [43,] -0.05441485
#>  [44,] -0.06260324
#>  [45,] -0.06582810
#>  [46,] -0.05746319
#>  [47,] -0.06387433
#>  [48,] -0.05651492
#>  [49,] -0.06450909
#>  [50,] -0.06004194
#>  [51,] -0.09504224
#>  [52,] -0.08945161
#>  [53,] -0.09510761
#>  [54,] -0.07581925
#>  [55,] -0.08918460
#>  [56,] -0.08203819
#>  [57,] -0.09030916
#>  [58,] -0.06725177
#>  [59,] -0.09001346
#>  [60,] -0.07469578
#>  [61,] -0.06751936
#>  [62,] -0.08314196
#>  [63,] -0.07881188
#>  [64,] -0.08680939
#>  [65,] -0.07684008
#>  [66,] -0.09069413
#>  [67,] -0.08239759
#>  [68,] -0.07976147
#>  [69,] -0.08392527
#>  [70,] -0.07650959
#>  [71,] -0.08766671
#>  [72,] -0.08249608
#>  [73,] -0.08803469
#>  [74,] -0.08606335
#>  [75,] -0.08684418
#>  [76,] -0.08951532
#>  [77,] -0.09242703
#>  [78,] -0.09403062
#>  [79,] -0.08513242
#>  [80,] -0.07537501
#>  [81,] -0.07479617
#>  [82,] -0.07408658
#>  [83,] -0.07904221
#>  [84,] -0.08772287
#>  [85,] -0.08083213
#>  [86,] -0.08728784
#>  [87,] -0.09247293
#>  [88,] -0.08421953
#>  [89,] -0.07990920
#>  [90,] -0.07661142
#>  [91,] -0.07897096
#>  [92,] -0.08667087
#>  [93,] -0.07918073
#>  [94,] -0.06763841
#>  [95,] -0.07925555
#>  [96,] -0.08105157
#>  [97,] -0.08083045
#>  [98,] -0.08527872
#>  [99,] -0.06778447
#> [100,] -0.07989976
#> [101,] -0.09883385
#> [102,] -0.08668234
#> [103,] -0.10267292
#> [104,] -0.09388623
#> [105,] -0.09761690
#> [106,] -0.11032883
#> [107,] -0.07528798
#> [108,] -0.10545579
#> [109,] -0.09650202
#> [110,] -0.10760130
#> [111,] -0.09431687
#> [112,] -0.09244794
#> [113,] -0.09818630
#> [114,] -0.08474780
#> [115,] -0.08795331
#> [116,] -0.09512829
#> [117,] -0.09531317
#> [118,] -0.11498985
#> [119,] -0.11148098
#> [120,] -0.08503284
#> [121,] -0.10118037
#> [122,] -0.08461872
#> [123,] -0.11067901
#> [124,] -0.08935180
#> [125,] -0.09966105
#> [126,] -0.10425751
#> [127,] -0.08843055
#> [128,] -0.08897460
#> [129,] -0.09479780
#> [130,] -0.10204616
#> [131,] -0.10494820
#> [132,] -0.11460154
#> [133,] -0.09497278
#> [134,] -0.09029217
#> [135,] -0.09043259
#> [136,] -0.10878848
#> [137,] -0.09691653
#> [138,] -0.09492653
#> [139,] -0.08765726
#> [140,] -0.09883051
#> [141,] -0.09885919
#> [142,] -0.09757664
#> [143,] -0.08668234
#> [144,] -0.10146686
#> [145,] -0.10036095
#> [146,] -0.09614970
#> [147,] -0.08926921
#> [148,] -0.09405930
#> [149,] -0.09488961
#> [150,] -0.08847836
#> 
#> $d
#> [1] 95.95991
#> 
#> $v
#>            [,1]
#> [1,] -0.7511082
#> [2,] -0.3800862
#> [3,] -0.5130089
#> [4,] -0.1679075
```
